<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

		<title>cosmoz-data-nav demo</title>

		<script src="../../webcomponentsjs/webcomponents-lite.js"></script>

		<link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html" />
		<link rel="import" href="../../iron-demo-helpers/demo-snippet.html" />

		<link rel="import" href="../../paper-icon-button/paper-icon-button.html" />
		<link rel="import" href="../../paper-spinner/paper-spinner-lite.html">
		<link rel="import" href="../../paper-input/paper-textarea.html">
		<link rel="import" href="../../iron-icons/iron-icons.html" />
		<link rel="import" href="./helpers/cosmoz-demo-view.html" />
		<link rel="import" href="../cosmoz-data-nav.html" />

		<custom-style>
			<style is="custom-style" include="demo-pages-shared-styles iron-flex">
				#container {
					max-width: 800px;
				}
				cosmoz-data-nav {
					display: block;
					height: 400px;
					position: relative;
				}
			</style>
		</custom-style>
	</head>
	<body unresolved>
		<div id="container" class="vertical-section-container centered">
			<h3>Basic <code>cosmoz-data-nav</code>.</h3>
			<demo-snippet>
				<template>
					<dom-bind id="basic">
						<template is="dom-bind">
							<cosmoz-data-nav items="[[ items ]]" index-as="index" as="item" on-need-data="onNeedData" selected="{{ selected }}">
								<template>
									<cosmoz-demo-view class="fit layout vertical" style$="background-color: {{ computeColor(index) }}" item="{{ item }}" index="[[index]]"></cosmoz-demo-view>
									<div incomplete-content class="layout vertical center-justified">
										<div class="layout horizontal center-justified center">
											<paper-spinner-lite active></paper-spinner-lite>
											<div style="margin-left: 10px">
												<h3>Data is updating</h3>
											</div>
										</div>
										<div class="layout horizontal center-justified center">
											<paper-icon-button slot="actions" disabled$="[[ prevDisabled ]]" icon="chevron-left" cosmoz-data-nav-select="-1"></paper-icon-button>
											<span>[[index]]</span>
											<paper-icon-button slot="actions" disabled$="[[ nextDisabled ]]" icon="chevron-right" cosmoz-data-nav-select="+1">></paper-icon-button>
										</div>
									</div>
								</template>
							</cosmoz-data-nav>
							<paper-textarea value="{{ computeJSON(selected, items.*) }}"><paper-textarea>
						</template>
					</dom-bind>
				</template>
			</demo-snippet>
		</div>
		<script type="text/javascript">
		(function () {
			window.addEventListener('WebComponentsReady', function () {
				let basic = document.getElementById('basic'),
					items =  Array(20).fill('').map((e, i) => i.toString());
				basic = !basic.set ? basic.firstElementChild : basic;

				basic.computeColor = function () {
					return '#' + Math.random().toString(16).slice(-3);
				};
				basic.onNeedData = function (event, detail) {
					console.log('on need data');
					Polymer.Base.async(() => {
						event.target.setItemById(detail.id, { id: detail.id });
					}, 5000);
					return { id: detail.id };
				};
				basic.computeJSON = function (index) {
					return JSON.stringify(this.items[index]);
				};
				basic.set('items', items);
			});

			///
		})();
		</script>
	</body>
</html>
