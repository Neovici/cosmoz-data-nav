<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="./cosmoz-templatize.html">
<link rel="import" href="../cosmoz-bottom-bar/cosmoz-bottom-bar-view.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<!--
`cosmoz-data-nav` provides a way to show each individual item of a list in a queue-style behavior
to the user.

A list of `items` and a `<template>` for each item is used to render the queue, and methods to
slide to next/previous item is exposed.

For performance and to avoid DOM bloat, the items are "lazy-rendered" and the `maxPreload` setting
decides how many _upcoming_ items that should be pre-rendered.

It can also be "lazy-loaded" when each item's details aren't available, by instead of (or in addition to)
`items` also set an `idList` array with identifiers for each item.
If `cosmoz-data-nav` tries to render an item that is missing but an id exists for the position, it will fire
a `need-data` event to announce this and expect an `object-details-fetched` event when the item details are
available. This event should have an `id` property that corresponds to the `id` requested and also an `object`
property with the item. This design enables parallelization since multiple items can be requested at once,
and responded to in an unordered, async manner. Also, `cosmoz-data-nav` does not need to be aware of any
template-design or item model.

Example:

    <cosmoz-data-nav id-list="[[ getItemIds(myList) ]]" on-need-data="triggerDetailFetch">
        <template>
            <neon-animatable class="vertical layout fit">
                <my-view>
                    <paper-icon-button slot="actions" disabled$="[[ isFirstItem ]]" icon="chevron-left" on-click="selectPrevious"></paper-icon-button>
                    <paper-icon-button slot="actions" disabled$="[[ isLastItem ]]" icon="chevron-right" on-click="selectNext"></paper-icon-button>
                </my-view>
            </neon-animatable>
        </template>
    </cosmoz-data-nav>

@demo demo/index.html
-->

<dom-module id="cosmoz-data-nav">
	<template>
		<style>
			:host {
				position: relative;
			}

			#items {
				overflow-x: hidden;
			}

			#items,
			#items > ::slotted(.animatable){
				@apply --layout-fit;
				transform: translateX(0px);
			}

			:host([animating]) #items > ::slotted(.animatable){
				transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1) 0s;
				backface-visibility: hidden;
			}

			:host([animating][reverse]) #items > ::slotted(.in),
			:host([animating]) #items > ::slotted(.out){
				transform: translateX(-100%);
			}

			:host([animating][reverse]) #items > ::slotted(.out),
			:host([animating]) #items > ::slotted(.in){
				transform: translateX(100%);
			}

			:host([animating]) #items > ::slotted(:not(.selected):not(.out)),
			:host(:not([animating])) #items > ::slotted(:not(.selected)) {
				display: none;
			}

			#items > ::slotted(.animatable)>[incomplete-content]{
				@apply --layout-fit;
			}

			#items > ::slotted(.animatable:not(.incomplete))>[incomplete-content],
			#items > ::slotted(.incomplete)>:not([incomplete-content]) {
				display: none;
			}

		</style>
		<div id="items">
			<slot></slot>
		</div>
		<template id="incomplete">
			<div incomplete visible$="[[ incomplete ]]">
				<cosmoz-bottom-bar-view active>
					<div slot="scroller-content" class="layout horizontal center-justified center">
						<paper-spinner-lite active></paper-spinner-lite>
						<div style="margin-left: 10px">
							<h3>[[ _('Data is updating', t) ]]</h3>
						</div>
					</div>
					<paper-icon-button disabled$="[[ prevDisabled ]]" icon="chevron-left" cosmoz-data-nav-select="-1"></paper-icon-button>
					<paper-icon-button disabled$="[[ nextDisabled ]]" icon="chevron-right" cosmoz-data-nav-select="+1">></paper-icon-button>
				</cosmoz-bottom-bar-view>
			</div>
		</template>
	</template>
	<script type="text/javascript" src="cosmoz-data-nav.js"></script>
</dom-module>
